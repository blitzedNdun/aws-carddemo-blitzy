# Test Configuration Properties - H2 In-Memory Database
# Overrides main application properties for testing

# Database Configuration - H2 In-Memory with PostgreSQL compatibility mode
spring.datasource.url=jdbc:h2:mem:testdb;MODE=PostgreSQL;DATABASE_TO_LOWER=TRUE;DEFAULT_NULL_ORDERING=HIGH;NON_KEYWORDS=KEY,VALUE
spring.datasource.username=sa
spring.datasource.password=
spring.datasource.driver-class-name=org.h2.Driver

# Connection Pool Configuration  
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=2
spring.datasource.hikari.connection-timeout=5000

# SQL Initialization
spring.sql.init.schema-locations=classpath:schema-test.sql
spring.sql.init.data-locations=classpath:test-data.sql
spring.sql.init.mode=always
spring.sql.init.continue-on-error=false

# JPA Configuration for H2
spring.jpa.database=postgresql
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.hibernate.ddl-auto=none
spring.jpa.hibernate.naming.physical-strategy=org.hibernate.boot.model.naming.CamelCaseToUnderscoresNamingStrategy
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.show_sql=false

# H2 Console
spring.h2.console.enabled=true

# Session Configuration for Testing (disabled)
spring.session.store-type=none

# Batch Configuration for Testing
spring.batch.job.enabled=false
spring.batch.jdbc.initialize-schema=embedded

# Redis Configuration for Testing (disabled - use in-memory session)
spring.redis.host=localhost
spring.redis.port=6379
spring.redis.timeout=2000ms

# Security Configuration for Testing
spring.security.user.name=admin
spring.security.user.password=admin
spring.security.user.roles=ADMIN

# Logging Configuration
logging.level.org.springframework=WARN
logging.level.com.carddemo=DEBUG
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql=TRACE

# Disable Liquibase for tests - use schema-test.sql instead
spring.liquibase.enabled=false

# Bean definition overriding
spring.main.allow-bean-definition-overriding=true