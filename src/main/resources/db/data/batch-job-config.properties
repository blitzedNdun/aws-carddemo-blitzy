# ===============================================================================
# Spring Batch Configuration Properties for CardDemo ASCII Data Loading
# Description: Execution parameters, chunk sizes, error handling, and performance 
#              tuning for ASCII data loading jobs supporting COBOL-to-Java migration
# Author: Blitzy Agent
# Version: 1.0
# Dependencies: Spring Batch 5.x, PostgreSQL 15+, HikariCP 5.1.x
# ===============================================================================
#
# This configuration file defines Spring Batch job execution parameters for
# loading ASCII data files (acctdata.txt, carddata.txt, custdata.txt, 
# dailytran.txt) into PostgreSQL tables with exact COBOL COMP-3 decimal 
# precision preservation and enterprise-grade fault tolerance.
#
# Performance Requirements:
# - Chunk-oriented processing with 1000-record chunks balancing memory 
#   consumption with commit frequency requirements per Section 6.2.4.5
# - Batch processing completion within 4-hour window
# - Memory usage maintained within 10% increase limit
# - Fault tolerance with configurable commit intervals and restart capability
# ===============================================================================

# =============================================================================
# BATCH JOB CONFIGURATION PROPERTIES
# Core execution parameters for all ASCII data loading jobs
# =============================================================================

# Job Execution Configuration
batch.job.enabled=true
batch.job.name=CardDemoDataLoadingJob
batch.job.description=ASCII data loading job for COBOL-to-Java migration
batch.job.version=1.0
batch.job.author=blitzy-agent

# Chunk Processing Configuration - Section 6.2.4.5 Compliance
batch.chunk.size=1000
batch.chunk.commit-interval=1000
batch.chunk.reader-transactional=true
batch.chunk.processor-transactional=false
batch.chunk.writer-transactional=true

# Transaction Management Configuration
batch.transaction.isolation-level=SERIALIZABLE
batch.transaction.propagation=REQUIRED
batch.transaction.timeout=300000
batch.transaction.rollback-for=java.lang.Exception
batch.transaction.no-rollback-for=org.springframework.batch.item.validator.ValidationException

# Performance Tuning Parameters
batch.performance.thread-pool-size=10
batch.performance.concurrent-execution=true
batch.performance.throttle-limit=10
batch.performance.max-memory-usage=85
batch.performance.gc-optimization=true

# =============================================================================
# MEMORY MANAGEMENT CONFIGURATION
# Maintains usage within 10% increase limit per performance requirements
# =============================================================================

# Memory Management Settings
batch.memory.heap-max-size=2048m
batch.memory.heap-initial-size=1024m
batch.memory.young-generation-size=512m
batch.memory.gc-type=G1GC
batch.memory.gc-threads=4
batch.memory.memory-monitoring=true
batch.memory.memory-threshold=90
batch.memory.memory-alert-enabled=true

# Buffer and Cache Configuration
batch.buffer.input-buffer-size=8192
batch.buffer.output-buffer-size=8192
batch.buffer.cache-size=10000
batch.buffer.cache-ttl=300000

# =============================================================================
# FAULT TOLERANCE AND RECOVERY CONFIGURATION
# Ensures reliable batch execution with restart capabilities
# =============================================================================

# Error Handling Configuration
batch.error.skip-limit=10
batch.error.retry-limit=3
batch.error.retry-delay=1000
batch.error.exponential-backoff=true
batch.error.backoff-multiplier=2.0
batch.error.max-retry-delay=30000

# Fault Tolerance Settings
batch.fault-tolerance.enabled=true
batch.fault-tolerance.restart-enabled=true
batch.fault-tolerance.restart-from-failure=true
batch.fault-tolerance.save-execution-context=true
batch.fault-tolerance.checkpoint-interval=1000

# Dead Letter Queue Configuration
batch.dlq.enabled=true
batch.dlq.queue-name=batch-error-queue
batch.dlq.max-retries=5
batch.dlq.retry-delay=5000
batch.dlq.dead-letter-expiration=86400000

# Job Restart Configuration
batch.restart.enabled=true
batch.restart.allow-start-if-complete=false
batch.restart.max-restart-attempts=3
batch.restart.restart-delay=10000

# =============================================================================
# SKIP AND RETRY LOGIC CONFIGURATION
# Handles transient failures with exponential backoff
# =============================================================================

# Skip Policy Configuration
batch.skip.enabled=true
batch.skip.skip-limit=10
batch.skip.skippable-exceptions=org.springframework.dao.DataIntegrityViolationException,\
                                org.springframework.batch.item.validator.ValidationException,\
                                org.springframework.batch.item.file.FlatFileParseException,\
                                java.lang.NumberFormatException

# Retry Policy Configuration
batch.retry.enabled=true
batch.retry.retry-limit=3
batch.retry.initial-delay=1000
batch.retry.max-delay=30000
batch.retry.multiplier=2.0
batch.retry.retryable-exceptions=org.springframework.dao.TransientDataAccessException,\
                                org.springframework.dao.DataAccessResourceFailureException,\
                                org.springframework.batch.item.ItemStreamException,\
                                java.sql.SQLTransientException

# Circuit Breaker Configuration
batch.circuit-breaker.enabled=true
batch.circuit-breaker.failure-threshold=5
batch.circuit-breaker.recovery-timeout=60000
batch.circuit-breaker.half-open-max-calls=3

# =============================================================================
# JOB EXECUTION TIMEOUT CONFIGURATION
# Supports 4-hour processing window requirement
# =============================================================================

# Job Timeout Settings
batch.job.timeout=14400000
batch.job.step-timeout=3600000
batch.job.reader-timeout=300000
batch.job.processor-timeout=60000
batch.job.writer-timeout=300000

# Step Execution Configuration
batch.step.allow-start-if-complete=false
batch.step.start-limit=3
batch.step.commit-interval=1000
batch.step.task-executor-core-pool-size=5
batch.step.task-executor-max-pool-size=10

# =============================================================================
# ENVIRONMENT-SPECIFIC CONFIGURATION
# Paths and validation thresholds for different environments
# =============================================================================

# Data File Paths Configuration
batch.data.input-path=classpath:db/data/
batch.data.output-path=/tmp/batch-output/
batch.data.error-path=/tmp/batch-errors/
batch.data.archive-path=/tmp/batch-archive/

# Account Data Configuration
batch.data.account.file-name=acctdata.txt
batch.data.account.record-count=50
batch.data.account.record-length=300
batch.data.account.validation-enabled=true
batch.data.account.chunk-size=1000

# Customer Data Configuration
batch.data.customer.file-name=custdata.txt
batch.data.customer.record-count=50
batch.data.customer.record-length=312
batch.data.customer.validation-enabled=true
batch.data.customer.chunk-size=1000
batch.data.customer.pii-protection=true

# Card Data Configuration
batch.data.card.file-name=carddata.txt
batch.data.card.record-count=50
batch.data.card.record-length=150
batch.data.card.validation-enabled=true
batch.data.card.chunk-size=1000
batch.data.card.luhn-validation=true

# Transaction Data Configuration
batch.data.transaction.file-name=dailytran.txt
batch.data.transaction.record-count=50
batch.data.transaction.record-length=189
batch.data.transaction.validation-enabled=true
batch.data.transaction.chunk-size=1000
batch.data.transaction.precision-validation=true

# Reference Data Configuration
batch.data.reference.enabled=true
batch.data.reference.chunk-size=1000
batch.data.reference.validation-enabled=true
batch.data.reference.cache-enabled=true

# =============================================================================
# VALIDATION THRESHOLDS
# Business rule validation and data quality checks
# =============================================================================

# Data Quality Validation
batch.validation.enabled=true
batch.validation.strict-mode=false
batch.validation.fail-on-error=false
batch.validation.max-error-count=10
batch.validation.error-threshold=5

# Business Rule Validation
batch.validation.business-rules.enabled=true
batch.validation.business-rules.account-balance-range=true
batch.validation.business-rules.customer-age-validation=true
batch.validation.business-rules.card-expiry-validation=true
batch.validation.business-rules.transaction-amount-validation=true

# Data Type Validation
batch.validation.data-types.enabled=true
batch.validation.data-types.decimal-precision=true
batch.validation.data-types.date-format=true
batch.validation.data-types.string-length=true
batch.validation.data-types.numeric-range=true

# =============================================================================
# MONITORING AND METRICS CONFIGURATION
# Performance monitoring and operational metrics
# =============================================================================

# Metrics Configuration
batch.metrics.enabled=true
batch.metrics.collection-interval=30000
batch.metrics.export-interval=60000
batch.metrics.retention-period=86400000

# Performance Metrics
batch.metrics.performance.enabled=true
batch.metrics.performance.response-time=true
batch.metrics.performance.throughput=true
batch.metrics.performance.error-rate=true
batch.metrics.performance.memory-usage=true

# Job Progress Monitoring
batch.monitoring.enabled=true
batch.monitoring.progress-reporting=true
batch.monitoring.progress-interval=1000
batch.monitoring.execution-summary=true
batch.monitoring.step-execution-details=true

# Alerting Configuration
batch.alerts.enabled=true
batch.alerts.performance-threshold=200
batch.alerts.error-threshold=5
batch.alerts.memory-threshold=85
batch.alerts.timeout-threshold=3600000

# =============================================================================
# LOGGING CONFIGURATION
# Comprehensive logging for debugging and audit trails
# =============================================================================

# Logging Configuration
batch.logging.enabled=true
batch.logging.level=INFO
batch.logging.file-appender=true
batch.logging.console-appender=true
batch.logging.structured-logging=true

# Audit Logging
batch.logging.audit.enabled=true
batch.logging.audit.job-execution=true
batch.logging.audit.step-execution=true
batch.logging.audit.item-processing=false
batch.logging.audit.error-logging=true

# Debug Logging
batch.logging.debug.enabled=false
batch.logging.debug.sql-statements=false
batch.logging.debug.parameter-binding=false
batch.logging.debug.transaction-details=false

# =============================================================================
# DATABASE CONFIGURATION
# PostgreSQL-specific batch processing settings
# =============================================================================

# Database Connection Settings
batch.database.connection-timeout=30000
batch.database.idle-timeout=600000
batch.database.max-lifetime=1800000
batch.database.leak-detection-threshold=60000

# Batch Database Operations
batch.database.batch-size=1000
batch.database.fetch-size=1000
batch.database.insert-batch-size=1000
batch.database.update-batch-size=1000

# Database Transaction Settings
batch.database.isolation-level=SERIALIZABLE
batch.database.auto-commit=false
batch.database.default-timeout=300000
batch.database.rollback-on-error=true

# =============================================================================
# SECURITY CONFIGURATION
# Security settings for batch job execution
# =============================================================================

# Security Settings
batch.security.enabled=true
batch.security.authentication-required=true
batch.security.authorization-enabled=true
batch.security.audit-enabled=true

# Job Security
batch.security.job.role-required=ROLE_BATCH_ADMIN
batch.security.job.encryption-enabled=false
batch.security.job.secure-parameters=true

# =============================================================================
# ENVIRONMENT-SPECIFIC OVERRIDES
# Different settings for development, testing, and production
# =============================================================================

# Development Environment
batch.env.development.chunk-size=100
batch.env.development.skip-limit=100
batch.env.development.retry-limit=5
batch.env.development.debug-enabled=true

# Testing Environment
batch.env.testing.chunk-size=500
batch.env.testing.skip-limit=50
batch.env.testing.retry-limit=3
batch.env.testing.validation-strict=true

# Production Environment
batch.env.production.chunk-size=1000
batch.env.production.skip-limit=10
batch.env.production.retry-limit=3
batch.env.production.monitoring-enhanced=true

# =============================================================================
# INTEGRATION CONFIGURATION
# Integration with external systems and services
# =============================================================================

# External Service Integration
batch.integration.enabled=true
batch.integration.timeout=30000
batch.integration.retry-attempts=3
batch.integration.circuit-breaker-enabled=true

# Notification Configuration
batch.notification.enabled=true
batch.notification.on-completion=true
batch.notification.on-failure=true
batch.notification.email-enabled=false
batch.notification.slack-enabled=false

# =============================================================================
# MAINTENANCE AND CLEANUP CONFIGURATION
# Automatic cleanup and maintenance tasks
# =============================================================================

# Cleanup Configuration
batch.cleanup.enabled=true
batch.cleanup.retention-days=7
batch.cleanup.archive-completed-jobs=true
batch.cleanup.cleanup-interval=86400000

# Maintenance Tasks
batch.maintenance.enabled=true
batch.maintenance.statistics-cleanup=true
batch.maintenance.log-cleanup=true
batch.maintenance.temporary-file-cleanup=true

# =============================================================================
# PERFORMANCE BASELINE CONFIGURATION
# Baseline performance metrics for comparison
# =============================================================================

# Performance Baselines
batch.baseline.processing-time=14400000
batch.baseline.throughput=1000
batch.baseline.memory-usage=2048
batch.baseline.error-rate=0.1

# Comparison Thresholds
batch.comparison.performance-degradation-threshold=10
batch.comparison.memory-increase-threshold=10
batch.comparison.error-rate-increase-threshold=50
batch.comparison.throughput-decrease-threshold=10

# =============================================================================
# END OF CONFIGURATION
# ===============================================================================