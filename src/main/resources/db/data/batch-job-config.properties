# =============================================================================
# Spring Batch Job Configuration Properties
# File: batch-job-config.properties
# Description: Central configuration properties for ASCII data loading batch jobs
# Author: Blitzy agent
# Version: 1.0
# Purpose: Define execution parameters, chunk sizes, error handling, and performance
#          tuning for Spring Batch jobs processing VSAM-to-PostgreSQL data migration
# =============================================================================

# =============================================================================
# CORE BATCH JOB EXECUTION PARAMETERS
# =============================================================================
# Primary configuration for chunk-oriented processing ensuring optimal memory
# usage and transaction boundary management per Section 6.2.4.5

# Chunk Processing Configuration
# 1000-record chunks balancing memory consumption with commit frequency requirements
batch.job.chunk-size=1000
batch.job.chunk-completion-policy=simple
batch.job.chunk-cache-capacity=100

# Commit Interval Configuration
# Configurable commit intervals supporting restart from failure points
batch.job.commit-intervals.default=1000
batch.job.commit-intervals.account-data=1000
batch.job.commit-intervals.customer-data=1000
batch.job.commit-intervals.card-data=1000
batch.job.commit-intervals.transaction-data=1000
batch.job.commit-intervals.reference-data=500

# Transaction Management
# SERIALIZABLE isolation level replicating VSAM record locking behavior
batch.job.transaction.isolation-level=SERIALIZABLE
batch.job.transaction.timeout-seconds=300
batch.job.transaction.propagation=REQUIRES_NEW

# =============================================================================
# FAULT TOLERANCE AND RECOVERY CONFIGURATION
# =============================================================================
# Comprehensive error handling and recovery mechanisms ensuring reliable
# batch execution with restart capabilities from failure points

# Skip Policy Configuration
# Configurable skip limits for data quality issues during initial load
batch.job.skip.enabled=true
batch.job.skip.limit.default=100
batch.job.skip.limit.account-data=50
batch.job.skip.limit.customer-data=25
batch.job.skip.limit.card-data=75
batch.job.skip.limit.transaction-data=100
batch.job.skip.limit.reference-data=10

# Skip Exception Types
batch.job.skip.exceptions=org.springframework.dao.DataIntegrityViolationException,\
  org.springframework.batch.item.file.FlatFileParseException,\
  org.springframework.batch.item.validator.ValidationException,\
  java.text.ParseException,\
  java.lang.NumberFormatException

# Retry Policy Configuration
# Exponential backoff and transient failure handling
batch.job.retry.enabled=true
batch.job.retry.max-attempts=3
batch.job.retry.initial-delay=1000
batch.job.retry.max-delay=10000
batch.job.retry.multiplier=2.0
batch.job.retry.backoff-policy=exponential

# Retry Exception Types
batch.job.retry.exceptions=org.springframework.dao.TransientDataAccessException,\
  org.springframework.dao.RecoverableDataAccessException,\
  java.sql.SQLException,\
  javax.persistence.PersistenceException,\
  org.hibernate.exception.LockAcquisitionException

# Dead Letter Queue Configuration
# Failed record processing and audit trail maintenance
batch.job.dead-letter.enabled=true
batch.job.dead-letter.queue-path=/var/log/carddemo/batch/dead-letter
batch.job.dead-letter.max-records-per-file=1000
batch.job.dead-letter.file-rotation=daily

# =============================================================================
# MEMORY MANAGEMENT AND PERFORMANCE TUNING
# =============================================================================
# Optimized memory usage maintaining 10% increase limit while supporting
# large batch volumes per performance requirements

# Memory Management Configuration
# JVM heap tuning with G1GC configuration maintaining memory limits
batch.job.memory.heap-size-mb=2048
batch.job.memory.max-heap-increase-percent=10
batch.job.memory.gc-algorithm=G1GC
batch.job.memory.gc-max-pause-ms=200

# Connection Pool Configuration
# HikariCP settings optimized for batch processing workloads
batch.job.datasource.hikari.maximum-pool-size=20
batch.job.datasource.hikari.minimum-idle=5
batch.job.datasource.hikari.connection-timeout=30000
batch.job.datasource.hikari.idle-timeout=600000
batch.job.datasource.hikari.max-lifetime=1800000
batch.job.datasource.hikari.leak-detection-threshold=60000

# Buffer and Cache Configuration
# Optimized I/O buffer sizes for ASCII file processing
batch.job.io.buffer-size=65536
batch.job.io.read-buffer-size=32768
batch.job.io.write-buffer-size=32768
batch.job.cache.item-cache-size=10000
batch.job.cache.metadata-cache-ttl=3600

# =============================================================================
# JOB EXECUTION TIMING AND SCHEDULING
# =============================================================================
# Configuration supporting 4-hour processing window requirement with
# comprehensive job orchestration and dependency management

# Job Execution Timeouts
# Processing window constraints ensuring completion within 4-hour window
batch.job.execution.timeout-hours=4
batch.job.execution.step-timeout-minutes=60
batch.job.execution.reader-timeout-minutes=30
batch.job.execution.writer-timeout-minutes=20
batch.job.execution.processor-timeout-minutes=45

# Parallel Processing Configuration
# Multiple concurrent job steps processing different account ranges
batch.job.parallel.enabled=true
batch.job.parallel.core-pool-size=4
batch.job.parallel.max-pool-size=8
batch.job.parallel.queue-capacity=100
batch.job.parallel.thread-name-prefix=batch-job-

# Job Scheduling Configuration
# Kubernetes CronJob integration replacing JCL scheduling
batch.job.scheduling.enabled=true
batch.job.scheduling.cron.daily-load=0 2 * * *
batch.job.scheduling.cron.incremental-load=0 */6 * * *
batch.job.scheduling.timezone=UTC

# =============================================================================
# DATA PROCESSING CONFIGURATION
# =============================================================================
# Specific configuration for processing ASCII data files with exact
# COBOL precision preservation and BigDecimal operations

# Account Data Processing (acctdata.txt)
# Fixed-width 300-byte records with COBOL COMP-3 decimal fields
batch.job.account-data.file-path=classpath:db/data/acctdata.txt
batch.job.account-data.record-length=300
batch.job.account-data.encoding=UTF-8
batch.job.account-data.delimiter-char={
batch.job.account-data.decimal-precision=2
batch.job.account-data.rounding-mode=HALF_EVEN
batch.job.account-data.math-context=DECIMAL128

# Customer Data Processing (custdata.txt)
# 312-character records with comprehensive customer information including PII
batch.job.customer-data.file-path=classpath:db/data/custdata.txt
batch.job.customer-data.record-length=312
batch.job.customer-data.encoding=UTF-8
batch.job.customer-data.pii-protection=true
batch.job.customer-data.ssn-encryption=true
batch.job.customer-data.address-validation=true

# Card Data Processing (carddata.txt)
# 150-character equivalent mapping with Luhn algorithm verification
batch.job.card-data.file-path=classpath:db/data/carddata.txt
batch.job.card-data.record-length=150
batch.job.card-data.encoding=UTF-8
batch.job.card-data.luhn-validation=true
batch.job.card-data.cvv-encryption=true
batch.job.card-data.pci-compliance=true

# Transaction Data Processing (dailytran.txt)
# 189-character equivalent records with BigDecimal precision handling
batch.job.transaction-data.file-path=classpath:db/data/dailytran.txt
batch.job.transaction-data.record-length=189
batch.job.transaction-data.encoding=UTF-8
batch.job.transaction-data.amount-precision=2
batch.job.transaction-data.timestamp-format=yyyy-MM-dd HH:mm:ss.SSSSSS
batch.job.transaction-data.partition-by-date=true

# Reference Data Processing (Multiple ASCII files)
# Processing 5 reference files for transaction types and categories
batch.job.reference-data.multi-resource=true
batch.job.reference-data.file-count=5
batch.job.reference-data.validation-strict=true
batch.job.reference-data.interest-rate-precision=4
batch.job.reference-data.category-validation=true

# =============================================================================
# FIELD MAPPING AND VALIDATION CONFIGURATION
# =============================================================================
# Comprehensive field validation and data integrity checks maintaining
# exact COBOL field format compliance and business rule enforcement

# Field Validation Patterns
# Regex patterns matching COBOL picture clauses for format validation
batch.job.validation.patterns.account-number=^[0-9]{11}$
batch.job.validation.patterns.customer-id=^[0-9]{9}$
batch.job.validation.patterns.card-number=^[0-9]{16}$
batch.job.validation.patterns.user-id=^[A-Z0-9]{8}$
batch.job.validation.patterns.transaction-id=^[A-Z0-9]{16}$
batch.job.validation.patterns.currency-code=^[A-Z]{3}$

# Data Range Validations
# Business rule constraints for financial and date fields
batch.job.validation.ranges.account-balance.min=-9999999999.99
batch.job.validation.ranges.account-balance.max=9999999999.99
batch.job.validation.ranges.credit-limit.min=0.00
batch.job.validation.ranges.credit-limit.max=999999999.99
batch.job.validation.ranges.fico-score.min=300
batch.job.validation.ranges.fico-score.max=850
batch.job.validation.ranges.date.min=1970-01-01
batch.job.validation.ranges.date.max=2050-12-31

# String Field Processing
# Whitespace handling and empty value conversion
batch.job.validation.strings.trim-whitespace=true
batch.job.validation.strings.empty-to-null=true
batch.job.validation.strings.null-to-empty=false
batch.job.validation.strings.max-length-check=true

# =============================================================================
# ERROR HANDLING AND LOGGING CONFIGURATION
# =============================================================================
# Comprehensive error logging and audit trail generation supporting
# compliance requirements and operational monitoring

# Error Logging Configuration
batch.job.logging.error-detail-level=DEBUG
batch.job.logging.stack-trace-enabled=true
batch.job.logging.error-summary=true
batch.job.logging.file-path=/var/log/carddemo/batch
batch.job.logging.max-file-size=100MB
batch.job.logging.max-history=30

# Audit Trail Configuration
batch.job.audit.enabled=true
batch.job.audit.log-level=INFO
batch.job.audit.include-data-values=false
batch.job.audit.record-counts=true
batch.job.audit.processing-times=true
batch.job.audit.memory-usage=true

# Performance Metrics
# Comprehensive batch job monitoring and performance tracking
batch.job.metrics.enabled=true
batch.job.metrics.export-interval=60
batch.job.metrics.include-jvm-metrics=true
batch.job.metrics.include-io-metrics=true
batch.job.metrics.prometheus-enabled=true

# =============================================================================
# ENVIRONMENT-SPECIFIC CONFIGURATION OVERRIDES
# =============================================================================
# Configuration variations for different deployment environments
# supporting development, test, and production scenarios

# Development Environment Overrides
batch.job.dev.chunk-size=100
batch.job.dev.skip-limit=10
batch.job.dev.retry-max-attempts=2
batch.job.dev.parallel-enabled=false
batch.job.dev.logging-level=DEBUG

# Test Environment Overrides
batch.job.test.chunk-size=500
batch.job.test.skip-limit=25
batch.job.test.retry-max-attempts=3
batch.job.test.parallel-enabled=true
batch.job.test.logging-level=INFO

# Production Environment Overrides
batch.job.prod.chunk-size=1000
batch.job.prod.skip-limit=100
batch.job.prod.retry-max-attempts=3
batch.job.prod.parallel-enabled=true
batch.job.prod.logging-level=WARN

# =============================================================================
# INTEGRATION AND DEPENDENCY CONFIGURATION
# =============================================================================
# Configuration for integration with Spring Boot application components
# and external systems supporting comprehensive batch processing

# Spring Integration Configuration
batch.job.spring.application-events=true
batch.job.spring.metrics-integration=true
batch.job.spring.security-context=true
batch.job.spring.transaction-manager=jpaTransactionManager

# Database Integration
batch.job.database.schema-validation=true
batch.job.database.foreign-key-checks=true
batch.job.database.constraint-validation=true
batch.job.database.sequence-management=true

# External System Integration
batch.job.external.notification-enabled=false
batch.job.external.webhook-url=
batch.job.external.api-timeout=30000
batch.job.external.retry-enabled=true

# =============================================================================
# MONITORING AND OBSERVABILITY CONFIGURATION
# =============================================================================
# Comprehensive monitoring configuration supporting operational visibility
# and performance optimization through metrics and health checks

# Health Check Configuration
batch.job.health.enabled=true
batch.job.health.endpoint-path=/actuator/batch/health
batch.job.health.timeout=30000
batch.job.health.detailed-status=true

# Metrics Export Configuration
batch.job.metrics.micrometer.enabled=true
batch.job.metrics.micrometer.step=10s
batch.job.metrics.micrometer.percentiles=0.5,0.95,0.99
batch.job.metrics.micrometer.histogram=true

# Alerting Configuration
batch.job.alerts.enabled=true
batch.job.alerts.error-threshold=10
batch.job.alerts.duration-threshold=3600
batch.job.alerts.memory-threshold=80
batch.job.alerts.notification-channels=log,email

# =============================================================================
# SECURITY AND COMPLIANCE CONFIGURATION
# =============================================================================
# Security controls and compliance settings ensuring data protection
# and audit trail maintenance throughout batch processing operations

# Data Security Configuration
batch.job.security.encryption-at-rest=true
batch.job.security.encryption-in-transit=true
batch.job.security.key-rotation-days=90
batch.job.security.access-logging=true

# PII Protection Configuration
batch.job.security.pii.mask-logging=true
batch.job.security.pii.encrypt-fields=ssn,card_number,cvv_code
batch.job.security.pii.audit-access=true
batch.job.security.pii.retention-days=2555

# Compliance Configuration
batch.job.compliance.pci-dss=true
batch.job.compliance.gdpr=true
batch.job.compliance.sox=true
batch.job.compliance.audit-retention=90

# =============================================================================
# ADVANCED PROCESSING CONFIGURATION
# =============================================================================
# Advanced processing features supporting complex data transformation
# and business rule enforcement during batch operations

# Data Transformation Configuration
batch.job.transformation.cobol-decimal-conversion=true
batch.job.transformation.date-format-standardization=true
batch.job.transformation.address-normalization=true
batch.job.transformation.phone-number-formatting=true

# Business Rule Enforcement
batch.job.business-rules.cross-field-validation=true
batch.job.business-rules.referential-integrity=true
batch.job.business-rules.balance-calculations=true
batch.job.business-rules.interest-rate-validation=true

# Performance Optimization
batch.job.optimization.read-ahead-cache=true
batch.job.optimization.write-behind-cache=true
batch.job.optimization.compression-enabled=true
batch.job.optimization.parallel-io=true

# =============================================================================
# RESTART AND RECOVERY CONFIGURATION
# =============================================================================
# Comprehensive restart and recovery mechanisms ensuring batch job
# resilience and data consistency across failure scenarios

# Job Restart Configuration
batch.job.restart.enabled=true
batch.job.restart.allow-start-if-complete=false
batch.job.restart.prevent-restart=false
batch.job.restart.auto-restart-failed-jobs=true

# Checkpoint Configuration
batch.job.checkpoint.enabled=true
batch.job.checkpoint.interval=1000
batch.job.checkpoint.policy=commit-count
batch.job.checkpoint.metadata-persistence=true

# Recovery Configuration
batch.job.recovery.rollback-on-error=true
batch.job.recovery.compensate-completed-steps=true
batch.job.recovery.cleanup-resources=true
batch.job.recovery.validate-on-restart=true

# =============================================================================
# FILE PROCESSING OPTIMIZATION
# =============================================================================
# Optimized file processing configuration supporting high-volume
# ASCII data loading with efficient I/O operations and memory management

# File I/O Configuration
batch.job.file.nio-enabled=true
batch.job.file.direct-buffer=true
batch.job.file.mapped-files=true
batch.job.file.read-chunk-size=8192

# Compression and Archival
batch.job.file.compression.enabled=false
batch.job.file.compression.algorithm=gzip
batch.job.file.archival.enabled=true
batch.job.file.archival.retention-days=30

# File Validation
batch.job.file.validation.checksum=true
batch.job.file.validation.size-check=true
batch.job.file.validation.format-check=true
batch.job.file.validation.encoding-check=true

# =============================================================================
# CUSTOM PROCESSOR CONFIGURATION
# =============================================================================
# Configuration for custom ItemProcessor implementations handling
# specialized business logic and data transformation requirements

# Account Data Processor Configuration
batch.job.processor.account.balance-calculation=true
batch.job.processor.account.credit-limit-validation=true
batch.job.processor.account.expiration-check=true
batch.job.processor.account.customer-reference-validation=true

# Customer Data Processor Configuration  
batch.job.processor.customer.address-standardization=true
batch.job.processor.customer.phone-validation=true
batch.job.processor.customer.ssn-validation=true
batch.job.processor.customer.credit-score-range-check=true

# Card Data Processor Configuration
batch.job.processor.card.luhn-algorithm=true
batch.job.processor.card.expiration-validation=true
batch.job.processor.card.account-linkage=true
batch.job.processor.card.duplicate-check=true

# Transaction Data Processor Configuration
batch.job.processor.transaction.amount-validation=true
batch.job.processor.transaction.timestamp-parsing=true
batch.job.processor.transaction.merchant-validation=true
batch.job.processor.transaction.category-validation=true

# =============================================================================
# END OF CONFIGURATION
# =============================================================================
# Total configuration properties: 200+
# Categories covered: Execution, Fault Tolerance, Memory Management, 
#                     Data Processing, Validation, Error Handling, 
#                     Environment Overrides, Integration, Monitoring,
#                     Security, Compliance, Advanced Processing, 
#                     Restart/Recovery, File Processing, Custom Processors
#
# This configuration file provides comprehensive control over all aspects
# of Spring Batch job execution for ASCII data loading operations, ensuring
# optimal performance, reliability, and compliance with business requirements.
# =============================================================================